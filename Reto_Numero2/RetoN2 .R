library(pracma)

x=c(0.2, 0.4, 0.4, 0.4, 0.6, 0.6, 0.6, 0.8, 0.8, 0.80, 1.00, 1.00, 1.20, 1.20, 1.4, 1.4, 1.6, 1.60, 1.8, 2.0, 2.0, 2.20, 2.4, 2.6, 2.6, 2.6, 3.0, 3.00, 3.20, 3.20, 3.4, 3.6, 3.8, 4.00, 4.0, 4.00, 4.40, 4.40, 4.40, 4.8, 4.80, 5.0, 5.2, 5.20, 5.40, 5.40, 5.60, 5.80, 6.0, 6.00, 6.20, 6.40, 6.40, 6.6, 6.80, 7.0, 7.00, 7.20, 7.40, 7.60, 7.6, 7.8, 8.00, 8.00, 8.2, 8.4, 8.40, 8.60, 8.60, 8.6, 8.77, 8.80, 8.80, 8.84, 9.0, 9.0, 9.20, 9.2, 9.20, 9.4, 9.4, 9.4, 9.54, 9.6, 9.62, 9.64)
y=c(4.2, 3.4, 3.8, 4.6, 3.0, 3.4, 5.0, 5.2, 3.2, 2.58, 2.22, 5.37, 2.97, 5.42, 1.8, 5.6, 2.8, 5.65, 1.4, 2.6, 5.8, 1.18, 6.0, 1.0, 2.4, 6.1, 0.8, 6.18, 0.62, 2.27, 6.2, 2.2, 0.4, 0.36, 2.2, 6.26, 0.26, 2.18, 6.25, 2.2, 6.32, 0.2, 2.2, 6.30, 0.24, 6.32, 2.26, 6.30, 0.3, 2.25, 6.24, 0.47, 2.08, 6.2, 1.98, 0.8, 6.16, 1.86, 0.96, 1.83, 6.0, 1.2, 1.72, 1.37, 5.8, 1.6, 1.88, 1.88, 2.07, 5.6, 2.40, 2.18, 2.76, 3.16, 2.4, 5.4, 2.83, 3.4, 5.19, 3.3, 3.6, 5.0, 4.80, 4.0, 4.58, 4.38)
plot(x,y,xlim=c(0,10),ylim =c(0,7),xlab = "x", ylab = "y",main = "Puntos Mortero Inicial")
bezierCurve <- function(x, y, n=10)
{
  outx <- NULL
  outy <- NULL
  
  i <- 1
  for (t in seq(0, 1, length.out=n))
  {
    b <- bez(x, y, t)
    outx[i] <- b$x
    outy[i] <- b$y
    
    i <- i+1
  }
  
  return (list(x=outx, y=outy))
}

bez <- function(x, y, t)
{
  outx <- 0
  outy <- 0
  n <- length(x)-1
  for (i in 0:n)
  {
    outx <- outx + choose(n, i)*((1-t)^(n-i))*t^i*x[i+1]
    outy <- outy + choose(n, i)*((1-t)^(n-i))*t^i*y[i+1]
  }
  
  return (list(x=outx, y=outy))
}

# Example usage
x1= c(0.2, 0.4, 0.6, 0.8, 1.00, 1.20, 1.4, 1.60, 2.0, 2.4, 2.6, 3.00,3.4, 4.00, 4.40)
y1= c(4.2, 4.6, 5.0, 5.2, 5.37, 5.42, 5.6, 5.65, 5.8, 6.0, 6.1, 6.18,6.2, 6.26, 6.25)
plot(x, y, "o", pch=20)
points(bezierCurve(x,y,20), type="l", col="red")


#Primera curva
x1= c(0.2, 0.4, 0.6, 0.8, 1.00, 1.20, 1.4, 1.60, 2.0, 2.4, 2.6, 3.00,3.4, 4.00, 4.40)
y1= c(4.2, 4.6, 5.0, 5.2, 5.37, 5.42, 5.6, 5.65, 5.8, 6.0, 6.1, 6.18,6.2, 6.26, 6.25)
plot(x1,y1,xlim=c(0,10),ylim =c(0,7),xlab = "x", ylab = "y",main = "Puntos Mortero")
par (new = TRUE)
##Segunda curva(Superior derecha)
x2=c(4.80, 5.20, 5.40, 5.80, 6.20, 6.6, 7.00, 7.6, 8.2, 8.6, 9.0, 9.20, 9.2, 9.4, 9.4, 9.54, 9.6, 9.62, 9.64)
y2=c(6.32, 6.30, 6.32, 6.30, 6.24, 6.2, 6.16, 6.0, 5.8, 5.6, 5.4, 5.19, 3.4, 3.6, 5.0, 4.80, 4.0, 4.58, 4.38)
plot(x2,y2,xlim=c(0,10),ylim =c(0,7),col ="red",xlab = "x", ylab = "y")
par (new = TRUE)
##3curva Pico
x3 = c(8.84, 8.77, 8.80, 8.60, 8.40 )
y3 = c(3.16, 2.40, 2.76, 2.07, 1.88 )
plot(x3,y3,xlim=c(0,10),ylim =c(0,7),col ="blue",xlab = "x", ylab = "y")
#4 curva
par (new = TRUE)
x4 = c(5.0, 5.40, 6.0, 6.40, 7.0 , 7.40, 7.8 , 8.00, 8.4, 8.60, 8.80, 9.0, 9.20, 9.4)
y4 = c(0.2, 0.24, 0.3, 0.47, 0.8 , 0.96, 1.2 , 1.37, 1.6, 1.88, 2.18, 2.4, 2.83, 3.3)
plot(x4,y4,xlim=c(0,10),ylim =c(0,7),col ="green",xlab = "x", ylab = "y")
#5 Curva de bezier 
par (new = TRUE)
x5 = c(0.4, 0.6, 0.80, 1.00, 1.4, 1.8, 2.20, 2.6, 3.0, 3.20, 3.8, 4.00, 4.40)
y5 = c(3.4, 3.0, 2.58, 2.22, 1.8, 1.4, 1.18, 1.0, 0.8, 0.62, 0.4, 0.36, 0.26)
plot(x5,y5,xlim=c(0,10),ylim =c(0,7),col ="purple",xlab = "x", ylab = "y")
#6 Curva
par (new = TRUE)
x6 = c(6.00, 6.40, 6.80, 7.20, 7.60, 8.00 )
y6 = c(2.25, 2.08, 1.98, 1.86, 1.83, 1.72 )
plot(x6,y6,xlim=c(0,10),ylim =c(0,7),col ="brown",xlab = "x", ylab = "y")
#7 Curva
par (new = TRUE)
x7=c(0.4, 0.6, 0.8, 1.20, 1.6, 2.0, 2.6, 3.20, 3.6, 4.0, 4.40, 4.8, 5.2, 5.60 )
y7=c(3.8, 3.4, 3.2, 2.97, 2.8, 2.6, 2.4, 2.27, 2.2, 2.2, 2.18, 2.2, 2.2, 2.26 )
plot(x7,y7,xlim=c(0,10),ylim =c(0,7),col =" salmon",xlab = "x", ylab = "y")





####################################
#Bezier
####################################

#Primera curva
x1= c(0.2, 0.4, 0.6, 0.8, 1.00, 1.20, 1.4, 1.60, 2.0, 2.4, 2.6, 3.00,3.4, 4.00, 4.40, 4.80)
y1= c(4.2, 4.6, 5.0, 5.2, 5.37, 5.42, 5.6, 5.65, 5.8, 6.0, 6.1, 6.18,6.2, 6.26, 6.25, 6.32)
vac1=''
vac2=''
plot(vac1,vac2,xlim=c(0,10),ylim =c(0,7),main = "Curvas de bezier",xlab = "x", ylab = "y")
points(bezierCurve(x1,y1,20), type="l", col="red")
par (new = TRUE)
##Segunda curva(Superior derecha)
x2=c(4.80, 5.20, 5.40, 5.80, 6.20, 6.6, 7.00, 7.6, 8.2, 8.6, 9.0, 9.20, 9.4, 9.54, 9.62, 9.64) #9.2,9.4,9.6
y2=c(6.32, 6.30, 6.32, 6.30, 6.24, 6.2, 6.16, 6.0, 5.8, 5.6, 5.4, 5.19, 5.0, 4.80, 4.58, 4.38) #3.4,3.6,4.0
points(bezierCurve(x2,y2,20), type="l", col="green")
par (new = TRUE)
##3curva Pico
x3 = c( 8.84, 8.77, 8.80, 8.60, 8.40 )
y3 = c( 3.16, 2.40, 2.76, 2.07, 1.88 )
points(bezierCurve(x3,y3,20), type="l", col="purple")
#4 curva
par (new = TRUE)
x4 = c(4.40,5.0, 5.40, 6.0, 6.40, 7.0 , 7.40, 7.8 , 8.00, 8.4, 8.60, 8.80, 9.0, 9.20, 9.4, 9.64)
y4 = c(0.26,0.2, 0.24, 0.3, 0.47, 0.8 , 0.96, 1.2 , 1.37, 1.6, 1.88, 2.18, 2.4, 2.83, 3.3, 4.38)
points(bezierCurve(x4,y4,20), type="l", col="blue")
#5 Curva de bezier 
par (new = TRUE)
x5 = c(0.2,0.4, 0.6, 0.80, 1.00, 1.4, 1.8, 2.20, 2.6, 3.0, 3.20, 3.8, 4.00, 4.40)
y5 = c(4.2,3.4, 3.0, 2.58, 2.22, 1.8, 1.4, 1.18, 1.0, 0.8, 0.62, 0.4, 0.36, 0.26)
points(bezierCurve(x5,y5,20), type="l", col="brown")
#6 Curva
par (new = TRUE)
x6 = c(5.8, 6.00, 6.40, 6.80, 7.20, 7.60, 8.00, 8.2)
y6 = c(2.2, 2.25, 2.08, 1.98, 1.86, 1.83, 1.72, 1.76)
points(bezierCurve(x6,y6,20), type="l", col="salmon")
#7 Curva
par (new = TRUE)
x7=c(0.2, 0.4, 0.6, 0.8, 1.20, 1.6, 2.0, 2.6, 3.20, 3.6, 4.0, 4.40, 4.8, 5.2, 5.60, 5.8 )
y7=c(4.2, 3.8, 3.4, 3.2, 2.97, 2.8, 2.6, 2.4, 2.27, 2.2, 2.2, 2.18, 2.2, 2.2, 2.26, 2.2)
points(bezierCurve(x7,y7,20), type="l", col="orange")
#curva3-6
par (new = TRUE)
x8=c(8.20, 8.40)
y8=c(1.76, 1.88)
points(bezierCurve(x8,y8,20), type="l", col="cornflowerblue")
#curva2-3
par (new = TRUE)
x9=c(8.84, 9.2, 9.4, 9.6, 9.64)
y9=c(3.16, 3.4, 3.6, 4.0, 4.38)
points(bezierCurve(x9,y9,20), type="l", col="darkred")

